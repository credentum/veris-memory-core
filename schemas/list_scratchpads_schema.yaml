---
schema_version: "1.0"
tool_name: "list_scratchpads"
description: "List active scratchpads filtered by API key namespace. By default shows only scratchpads belonging to the current user, plus any shared scratchpads."

input_schema:
  type: object
  properties:
    pattern:
      type: string
      description: "Glob pattern to filter agent_ids (e.g., 'claude*', '*research*')"
      default: "*"
      examples:
        - "*"
        - "claude*"
        - "*research*"
        - "herald-*"

    include_values:
      type: boolean
      description: "Include scratchpad values in response (default: false, keys only)"
      default: false

    include_shared:
      type: boolean
      description: "Include shared scratchpads from other teams (default: true). When false, only shows scratchpads owned by the current API key's user_id."
      default: true

  required: []

output_schema:
  type: object
  properties:
    success:
      type: boolean
      description: "Whether the operation succeeded"

    agents:
      type: array
      description: "List of agents with their scratchpad info"
      items:
        type: object
        properties:
          agent_id:
            type: string
            description: "The agent identifier"
          keys:
            type: array
            items:
              type: string
            description: "List of scratchpad keys for this agent"
          key_count:
            type: integer
            description: "Number of scratchpad keys"
          data:
            type: object
            description: "Scratchpad values (only if include_values=true)"

    total_agents:
      type: integer
      description: "Total number of agents with active scratchpads"

    total_keys:
      type: integer
      description: "Total number of scratchpad keys across all agents"

    user_id:
      type: string
      description: "Current user_id from API key (for namespace filtering)"

    include_shared:
      type: boolean
      description: "Whether shared scratchpads were included"

    message:
      type: string
      description: "Success or error message"

    error_type:
      type: string
      description: "Classification of error type (only on failure)"
      enum:
        - "rate_limit"
        - "storage_unavailable"
        - "storage_exception"
        - "unexpected_error"

  required:
    - success
    - agents
    - message

use_cases:
  discover_all:
    description: "Find all active scratchpads for your team (plus shared)"
    example:
      input: {}
      expected_output:
        success: true
        agents:
          - agent_id: "claude-research"
            keys: ["current_task", "notes"]
            key_count: 2
          - agent_id: "herald-bot"
            keys: ["draft"]
            key_count: 1
        total_agents: 2
        total_keys: 3
        user_id: "research_team"
        include_shared: true
        message: "Found 2 agents with 3 scratchpad entries"

  filter_by_pattern:
    description: "Find scratchpads matching a pattern (partial recall)"
    example:
      input:
        pattern: "claude*"
      expected_output:
        success: true
        agents:
          - agent_id: "claude-research"
            keys: ["current_task", "notes"]
            key_count: 2
        total_agents: 1
        total_keys: 2
        user_id: "research_team"
        include_shared: true
        message: "Found 1 agents with 2 scratchpad entries"

  own_scratchpads_only:
    description: "List only scratchpads owned by your team (exclude shared)"
    example:
      input:
        include_shared: false
      expected_output:
        success: true
        agents:
          - agent_id: "claude-research"
            keys: ["current_task"]
            key_count: 1
        total_agents: 1
        total_keys: 1
        user_id: "research_team"
        include_shared: false
        message: "Found 1 agents with 1 scratchpad entries"

  include_values:
    description: "Get scratchpad keys with their values"
    example:
      input:
        include_values: true
      expected_output:
        success: true
        agents:
          - agent_id: "claude-research"
            keys: ["current_task"]
            key_count: 1
            data:
              current_task: "Investigating API performance"
        total_agents: 1
        total_keys: 1
        user_id: "research_team"
        include_shared: true
        message: "Found 1 agents with 1 scratchpad entries"

security_features:
  - "Read-only operation - cannot modify scratchpads"
  - "Rate limiting prevents excessive usage"
  - "Namespace isolation by API key user_id"
  - "Cross-team visibility via shared flag only"
  - "Backwards compatible with legacy scratchpads (no metadata = visible)"

examples:
  basic_discovery:
    description: "Discover scratchpads for your team (plus shared)"
    input: {}
    curl: |
      curl -X POST http://localhost:8000/tools/list_scratchpads \
        -H "Content-Type: application/json" \
        -H "X-API-Key: your-api-key" \
        -d '{}'

  pattern_filter:
    description: "Find scratchpads for agents starting with 'claude'"
    input:
      pattern: "claude*"
    curl: |
      curl -X POST http://localhost:8000/tools/list_scratchpads \
        -H "Content-Type: application/json" \
        -H "X-API-Key: your-api-key" \
        -d '{"pattern": "claude*"}'

  own_only:
    description: "List only your team's scratchpads (exclude shared from other teams)"
    input:
      include_shared: false
    curl: |
      curl -X POST http://localhost:8000/tools/list_scratchpads \
        -H "Content-Type: application/json" \
        -H "X-API-Key: your-api-key" \
        -d '{"include_shared": false}'

  with_values:
    description: "Get all scratchpads with their values"
    input:
      include_values: true
    curl: |
      curl -X POST http://localhost:8000/tools/list_scratchpads \
        -H "Content-Type: application/json" \
        -H "X-API-Key: your-api-key" \
        -d '{"include_values": true}'
